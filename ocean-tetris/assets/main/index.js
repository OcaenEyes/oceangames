System.register("chunks:///_virtual/core.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(o){"use strict";var t,i,s,c,l,r,e,h,u,n,P,k,B,a,x,b,y;return{setters:[function(o){t=o.applyDecoratedDescriptor,i=o.inheritsLoose,s=o.initializerDefineProperty,c=o.assertThisInitialized},function(o){l=o.cclegacy,r=o._decorator,e=o.Node,h=o.Prefab,u=o.Label,n=o.find,P=o.log,k=o.instantiate,B=o.v2,a=o.KeyCode,x=o.input,b=o.Input,y=o.Component}],execute:function(){var p,m,g,f,C,d,v,L,w,R,G,S,z,D,O,M,_,T,W,E,K,A,Z,N,F,V,I,Y,H;l._RF.push({},"3ab658/zE5BzLe2ahh0l8s3","core",void 0);var j=r.ccclass,U=r.property;o("core",(p=j("core"),m=U(e),g=U(h),f=U(e),C=U(h),d=U(h),v=U(h),L=U(h),w=U(h),R=U(h),G=U(h),S=U(h),z=U(e),D=U(u),p((_=t((M=function(o){function t(){for(var t,i=arguments.length,l=new Array(i),r=0;r<i;r++)l[r]=arguments[r];return t=o.call.apply(o,[this].concat(l))||this,s(t,"gcBgLayout",_,c(t)),s(t,"gbBlock",T,c(t)),s(t,"gcLayout",W,c(t)),s(t,"gameBlock0",E,c(t)),s(t,"gameBlock1",K,c(t)),s(t,"gameBlock2",A,c(t)),s(t,"gameBlock3",Z,c(t)),s(t,"gameBlock4",N,c(t)),s(t,"gameBlock5",F,c(t)),s(t,"gameBlock6",V,c(t)),s(t,"gameBlockCenter",I,c(t)),s(t,"testLayout",Y,c(t)),s(t,"scoreValue",H,c(t)),t.rand=null,t._score=0,t.box=[],t.curBlock=null,t.curBlockP1=null,t.curBlockP2=null,t.curBlockP3=null,t.curBlockP4=null,t.curBlockP1Pos=null,t.curBlockP2Pos=null,t.curBlockP3Pos=null,t.curBlockP4Pos=null,t.gameState=null,t}i(t,o);var l=t.prototype;return l.start=function(){this.initBgBlock(),this.scoreValue.string="0",n("GameMusic").emit("bgm")},l.update=function(o){},l.initBgBlock=function(){P("初始化程序");for(var o=0;o<200;o++){k(this.gbBlock).parent=this.gcBgLayout}},l.initBox=function(){for(var o=0;o<24;o++){this.box[o]=[];for(var t=0;t<10;t++)this.box[o][t]=null}this.initGameBlock()},l.initGameBlock=function(){this.rand=Math.floor(7*Math.random()),this.createBlockColor(this.rand),this.createBlockShape(this.rand)},l.createBlockColor=function(o){switch(o){case 0:P("初始化正方形颜色"),this.curBlockP1=k(this.gameBlock0),this.curBlockP2=k(this.gameBlock0),this.curBlockP3=k(this.gameBlock0),this.curBlockP4=k(this.gameBlock0),this.curBlock=k(this.gameBlockCenter),this.curBlock.parent=this.gcLayout,this.curBlock.setPosition(0,571),P("正方形颜色的位置,",this.curBlock.position);break;case 1:P("初始化Z形颜色"),this.curBlockP1=k(this.gameBlock1),this.curBlockP2=k(this.gameBlock1),this.curBlockP3=k(this.gameBlock1),this.curBlockP4=k(this.gameBlock1),this.curBlock=k(this.gameBlockCenter),this.curBlock.parent=this.gcLayout,this.curBlock.setPosition(27,596),P("Z颜色的位置,",this.curBlock.position);break;case 2:P("初始化反Z形颜色"),this.curBlockP1=k(this.gameBlock2),this.curBlockP2=k(this.gameBlock2),this.curBlockP3=k(this.gameBlock2),this.curBlockP4=k(this.gameBlock2),this.curBlock=k(this.gameBlockCenter),this.curBlock.parent=this.gcLayout,this.curBlock.setPosition(27,596),P("反Z颜色的位置,",this.curBlock.position);break;case 3:P("初始化左L形颜色"),this.curBlockP1=k(this.gameBlock3),this.curBlockP2=k(this.gameBlock3),this.curBlockP3=k(this.gameBlock3),this.curBlockP4=k(this.gameBlock3),this.curBlock=k(this.gameBlockCenter),this.curBlock.parent=this.gcLayout,this.curBlock.setPosition(27,596),P("左L颜色的位置,",this.curBlock.position);break;case 4:P("初始化右L形颜色"),this.curBlockP1=k(this.gameBlock4),this.curBlockP2=k(this.gameBlock4),this.curBlockP3=k(this.gameBlock4),this.curBlockP4=k(this.gameBlock4),this.curBlock=k(this.gameBlockCenter),this.curBlock.parent=this.gcLayout,this.curBlock.setPosition(27,596),P("右L颜色的位置,",this.curBlock.position);break;case 5:P("初始化T形颜色"),this.curBlockP1=k(this.gameBlock5),this.curBlockP2=k(this.gameBlock5),this.curBlockP3=k(this.gameBlock5),this.curBlockP4=k(this.gameBlock5),this.curBlock=k(this.gameBlockCenter),this.curBlock.parent=this.gcLayout,this.curBlock.setPosition(27,546),P("T颜色的位置,",this.curBlock.position);break;case 6:P("初始化长形颜色"),this.curBlockP1=k(this.gameBlock6),this.curBlockP2=k(this.gameBlock6),this.curBlockP3=k(this.gameBlock6),this.curBlockP4=k(this.gameBlock6),this.curBlock=k(this.gameBlockCenter),this.curBlock.parent=this.gcLayout,this.curBlock.setPosition(27,596),P("T颜色的位置,",this.curBlock.position)}this.curBlock.addChild(this.curBlockP1),this.curBlock.addChild(this.curBlockP2),this.curBlock.addChild(this.curBlockP3),this.curBlock.addChild(this.curBlockP4)},l.createBlockShape=function(o){switch(o){case 0:P("初始化正方形"),this.curBlockP1.setPosition(26,26),this.curBlockP2.setPosition(-26,26),this.curBlockP3.setPosition(26,-26),this.curBlockP4.setPosition(-26,-26),this.curBlockP1Pos=B(21,5),this.curBlockP2Pos=B(21,4),this.curBlockP3Pos=B(20,5),this.curBlockP4Pos=B(20,4);break;case 1:P("初始化Z形"),this.curBlockP1.setPosition(-52,0),this.curBlockP2.setPosition(0,0),this.curBlockP3.setPosition(0,-52),this.curBlockP4.setPosition(52,-52),this.curBlockP1Pos=B(21,4),this.curBlockP2Pos=B(21,5),this.curBlockP3Pos=B(20,5),this.curBlockP4Pos=B(20,6);break;case 2:P("初始化反Z形"),this.curBlockP1.setPosition(52,0),this.curBlockP2.setPosition(0,0),this.curBlockP3.setPosition(0,-52),this.curBlockP4.setPosition(-52,-52),this.curBlockP1Pos=B(21,6),this.curBlockP2Pos=B(21,5),this.curBlockP3Pos=B(20,5),this.curBlockP4Pos=B(20,4);break;case 3:P("初始化左L形"),this.curBlockP1.setPosition(0,52),this.curBlockP2.setPosition(0,0),this.curBlockP3.setPosition(0,-52),this.curBlockP4.setPosition(52,-52),this.curBlockP1Pos=B(22,5),this.curBlockP2Pos=B(21,5),this.curBlockP3Pos=B(20,5),this.curBlockP4Pos=B(20,6);break;case 4:P("初始化右L形"),this.curBlockP1.setPosition(0,52),this.curBlockP2.setPosition(0,0),this.curBlockP3.setPosition(0,-52),this.curBlockP4.setPosition(-52,-52),this.curBlockP1Pos=B(22,5),this.curBlockP2Pos=B(21,5),this.curBlockP3Pos=B(20,5),this.curBlockP4Pos=B(20,4);break;case 5:P("初始化T形"),this.curBlockP1.setPosition(0,52),this.curBlockP2.setPosition(0,0),this.curBlockP3.setPosition(-52,0),this.curBlockP4.setPosition(52,0),this.curBlockP1Pos=B(21,5),this.curBlockP2Pos=B(20,5),this.curBlockP3Pos=B(20,4),this.curBlockP4Pos=B(20,6);break;case 6:P("初始化竖形"),this.curBlockP1.setPosition(0,104),this.curBlockP2.setPosition(0,52),this.curBlockP3.setPosition(0,0),this.curBlockP4.setPosition(0,-52),this.curBlockP1Pos=B(23,5),this.curBlockP2Pos=B(22,5),this.curBlockP3Pos=B(21,5),this.curBlockP4Pos=B(20,5)}this.checkCurrentBlockPos()},l.isClashBottom=function(){return this.curBlockP1Pos.x-1<0||this.curBlockP2Pos.x-1<0||this.curBlockP3Pos.x-1<0||this.curBlockP4Pos.x-1<0},l.isClashBottomBlock=function(){return P(this.box),P(this.box[this.curBlockP1Pos.x-1][this.curBlockP1Pos.y]),null!=this.box[this.curBlockP1Pos.x-1][this.curBlockP1Pos.y]&&!this.isCurrentBlockChild(this.box[this.curBlockP1Pos.x-1][this.curBlockP1Pos.y])||null!=this.box[this.curBlockP2Pos.x-1][this.curBlockP2Pos.y]&&!this.isCurrentBlockChild(this.box[this.curBlockP2Pos.x-1][this.curBlockP2Pos.y])||null!=this.box[this.curBlockP3Pos.x-1][this.curBlockP3Pos.y]&&!this.isCurrentBlockChild(this.box[this.curBlockP3Pos.x-1][this.curBlockP3Pos.y])||null!=this.box[this.curBlockP4Pos.x-1][this.curBlockP4Pos.y]&&!this.isCurrentBlockChild(this.box[this.curBlockP4Pos.x-1][this.curBlockP4Pos.y])},l.isClashLeft=function(){return this.curBlockP1Pos.y-1<0||this.curBlockP2Pos.y-1<0||this.curBlockP3Pos.y-1<0||this.curBlockP4Pos.y-1<0},l.isClashLeftBlock=function(){return P(this.box),P(this.box[this.curBlockP1Pos.x][this.curBlockP1Pos.y-1]),null!=this.box[this.curBlockP1Pos.x][this.curBlockP1Pos.y-1]&&!this.isCurrentBlockChild(this.box[this.curBlockP1Pos.x][this.curBlockP1Pos.y-1])||null!=this.box[this.curBlockP2Pos.x][this.curBlockP2Pos.y-1]&&!this.isCurrentBlockChild(this.box[this.curBlockP2Pos.x][this.curBlockP2Pos.y-1])||null!=this.box[this.curBlockP3Pos.x][this.curBlockP3Pos.y-1]&&!this.isCurrentBlockChild(this.box[this.curBlockP3Pos.x][this.curBlockP3Pos.y-1])||null!=this.box[this.curBlockP4Pos.x][this.curBlockP4Pos.y-1]&&!this.isCurrentBlockChild(this.box[this.curBlockP4Pos.x][this.curBlockP4Pos.y-1])},l.isClashRight=function(){return this.curBlockP1Pos.y+1>9||this.curBlockP2Pos.y+1>9||this.curBlockP3Pos.y+1>9||this.curBlockP4Pos.y+1>9},l.isClashRightBlock=function(){return P(this.box),P(this.box[this.curBlockP1Pos.x][this.curBlockP1Pos.y+1]),null!=this.box[this.curBlockP1Pos.x][this.curBlockP1Pos.y+1]&&!this.isCurrentBlockChild(this.box[this.curBlockP1Pos.x][this.curBlockP1Pos.y+1])||null!=this.box[this.curBlockP2Pos.x][this.curBlockP2Pos.y+1]&&!this.isCurrentBlockChild(this.box[this.curBlockP2Pos.x][this.curBlockP2Pos.y+1])||null!=this.box[this.curBlockP3Pos.x][this.curBlockP3Pos.y+1]&&!this.isCurrentBlockChild(this.box[this.curBlockP3Pos.x][this.curBlockP3Pos.y+1])||null!=this.box[this.curBlockP4Pos.x][this.curBlockP4Pos.y+1]&&!this.isCurrentBlockChild(this.box[this.curBlockP4Pos.x][this.curBlockP4Pos.y+1])},l.rotateShape=function(){P("旋转图形"),this.rotateShapePart(this.curBlockP1,this.curBlockP1Pos),this.rotateShapePart(this.curBlockP2,this.curBlockP2Pos),this.rotateShapePart(this.curBlockP3,this.curBlockP3Pos),this.rotateShapePart(this.curBlockP4,this.curBlockP4Pos)},l.rotateShapePart=function(o,t){P(o.position);var i=Math.abs(o.position.x/52),s=Math.abs(o.position.y/52),c=Math.max(i,s);0==o.position.x&&o.position.y>0?(t.x-=c,t.y+=c,o.setPosition(o.position.y,o.position.x)):o.position.x>0&&0==o.position.y?(t.x-=c,t.y-=c,o.setPosition(o.position.y,-o.position.x)):0==o.position.x&&o.position.y<0?(t.x+=c,t.y-=c,o.setPosition(o.position.y,o.position.x)):o.position.x<0&&0==o.position.y?(t.x+=c,t.y+=c,o.setPosition(o.position.y,-o.position.x)):o.position.x>0&&o.position.y>0?(P("从右上顺时针旋转"),o.position.x>=52&&o.position.y>=52?t.x-=2:t.x-=1,o.setPosition(o.position.x,-o.position.y)):o.position.x>0&&o.position.y<0?(P("从右下顺时针旋转"),o.position.x>=52&&o.position.y<=-52?t.y-=2:t.y-=1,o.setPosition(-o.position.x,o.position.y)):o.position.x<0&&o.position.y<0?(P("从左下顺时针旋转"),o.position.x<=-52&&o.position.y<=-52?t.x+=2:t.x+=1,o.setPosition(o.position.x,-o.position.y)):o.position.x<0&&o.position.y>0&&(P("从左上顺时针旋转"),o.position.x<=-52&&o.position.y>=52?t.y+=2:t.y+=1,o.setPosition(-o.position.x,o.position.y)),P("旋转后最新对位置：",o.position)},l.isCurrentBlockChild=function(o){for(var t=0;t<4;t++)if(o===this.curBlock.children[t])return!0;return!1},l.checkCurrentBlockPos=function(){this.box[this.curBlockP1Pos.x][this.curBlockP1Pos.y]=this.curBlockP1,this.box[this.curBlockP2Pos.x][this.curBlockP2Pos.y]=this.curBlockP2,this.box[this.curBlockP3Pos.x][this.curBlockP3Pos.y]=this.curBlockP3,this.box[this.curBlockP4Pos.x][this.curBlockP4Pos.y]=this.curBlockP4},l.deleteCurrentBlockPos=function(){this.box[this.curBlockP1Pos.x][this.curBlockP1Pos.y]=null,this.box[this.curBlockP2Pos.x][this.curBlockP2Pos.y]=null,this.box[this.curBlockP3Pos.x][this.curBlockP3Pos.y]=null,this.box[this.curBlockP4Pos.x][this.curBlockP4Pos.y]=null},l.autoDown=function(){var o=this;this.schedule((function(){o.isClashBottom()?(P("碰到底部了"),o.deleteRow(),o.initGameBlock()):o.isClashBottomBlock()?(P("碰到下面的方块了"),o.isGameOver(),o.deleteRow(),o.initGameBlock()):(o.curBlock.setPosition(o.curBlock.position.x,o.curBlock.position.y-52),o.deleteCurrentBlockPos(),o.curBlockP1Pos.x-=1,o.curBlockP2Pos.x-=1,o.curBlockP3Pos.x-=1,o.curBlockP4Pos.x-=1,o.checkCurrentBlockPos())}),.5)},l.deleteRow=function(){for(var o=0;o<18;o++){for(var t=0,i=0;i<10;i++)null!=this.box[o][i]&&t++;if(10==t){for(var s=0;s<10;s++)this.box[o][s].removeFromParent(),this.box[o][s]=null,n("GameMusic").emit("cleanOneLine"),this._score+=1,this.scoreValue.string=this._score.toString();this.rowDown(o),o--}}},l.rowDown=function(o){for(var t=o,i=0;i<10;i++)for(var s=-1,c=t;c<18;c++)s++,null!=this.box[c][i]&&(this.box[c-1][i]=this.box[c][i],this.box[c][i].setPosition(this.box[c][i].position.x,this.box[c][i].position.y-52),null==this.box[c+1][i]&&(this.box[s+t][i]=null))},l.onKeyDown=function(o){switch(o.keyCode){case a.ARROW_LEFT:if(P("左移动"),this.isClashLeft())break;if(this.isClashLeftBlock())break;this.curBlock.setPosition(this.curBlock.position.x-52,this.curBlock.position.y),this.deleteCurrentBlockPos(),this.curBlockP1Pos.y-=1,this.curBlockP2Pos.y-=1,this.curBlockP3Pos.y-=1,this.curBlockP4Pos.y-=1,this.checkCurrentBlockPos();break;case a.ARROW_RIGHT:if(P("右移动"),n("GameMusic").emit("rotate"),this.isClashRight())break;if(this.isClashRightBlock())break;this.curBlock.setPosition(this.curBlock.position.x+52,this.curBlock.position.y),this.deleteCurrentBlockPos(),this.curBlockP1Pos.y+=1,this.curBlockP2Pos.y+=1,this.curBlockP3Pos.y+=1,this.curBlockP4Pos.y+=1,this.checkCurrentBlockPos();break;case a.ARROW_UP:if(n("GameMusic").emit("rotate"),this.isClashBottom())break;if(this.isClashBottomBlock())break;if(this.isClashLeft())break;if(this.isClashLeftBlock())break;if(this.isClashRight())break;if(this.isClashRightBlock())break;this.deleteCurrentBlockPos(),this.rotateShape(),this.checkCurrentBlockPos();break;case a.ARROW_DOWN:if(P("下移动"),n("GameMusic").emit("rotate"),this.isClashBottom())break;if(this.isClashBottomBlock())break;this.curBlock.setPosition(this.curBlock.position.x,this.curBlock.position.y-52),this.deleteCurrentBlockPos(),this.curBlockP1Pos.x-=1,this.curBlockP2Pos.x-=1,this.curBlockP3Pos.x-=1,this.curBlockP4Pos.x-=1,this.checkCurrentBlockPos()}},l.gameStart=function(){var o=n("Canvas/GameWelcome"),t=n("Canvas/GameOver");o.active=!1,t.active=!1,this.gameState=1,x.on(b.EventType.KEY_DOWN,this.onKeyDown,this),this.initBox(),this.autoDown()},l.gameResume=function(){this.gameState=1},l.gamePause=function(){this.gameState=2},l.gameOver=function(){this.gameState=0,n("Canvas/GameOver").active=!0,n("GameMusic").emit("gameover"),n("GameMusic").emit("bgmStop"),this.enabled=!1,x.off(b.EventType.KEY_DOWN,this.onKeyDown,this)},l.gameRestart=function(){this.gameState=1,n("Canvas/GameOver").active=!1,this.enabled=!0,this.gcLayout.removeAllChildren(),x.on(b.EventType.KEY_DOWN,this.onKeyDown,this),n("GameMusic").emit("bgm"),this.initBox(),this.autoDown()},l.isGameOver=function(){for(var o=18;o<20;o++)for(var t=0;t<10;t++)null!=this.box[o][t]&&this.gameOver()},t}(y)).prototype,"gcBgLayout",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(M.prototype,"gbBlock",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(M.prototype,"gcLayout",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=t(M.prototype,"gameBlock0",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=t(M.prototype,"gameBlock1",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(M.prototype,"gameBlock2",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=t(M.prototype,"gameBlock3",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=t(M.prototype,"gameBlock4",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(M.prototype,"gameBlock5",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(M.prototype,"gameBlock6",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=t(M.prototype,"gameBlockCenter",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=t(M.prototype,"testLayout",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(M.prototype,"scoreValue",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=M))||O));l._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./core.ts","./music.ts"],(function(){"use strict";return{setters:[null,null],execute:function(){}}}));

System.register("chunks:///_virtual/music.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var n,o,e,i,r,u,s,c,a;return{setters:[function(t){n=t.applyDecoratedDescriptor,o=t.inheritsLoose,e=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){r=t.cclegacy,u=t._decorator,s=t.AudioSource,c=t.AudioClip,a=t.Component}],execute:function(){var l,f,p,d,h,y,m;r._RF.push({},"486c57woVxOxbaB0yP15dx4","music",void 0);var v=u.ccclass,b=u.property;t("music",(l=v("music"),f=b(s),p=b([c]),l((y=n((h=function(t){function n(){for(var n,o=arguments.length,r=new Array(o),u=0;u<o;u++)r[u]=arguments[u];return n=t.call.apply(t,[this].concat(r))||this,e(n,"soundControl",y,i(n)),e(n,"effects",m,i(n)),n}o(n,t);var r=n.prototype;return r.start=function(){},r.update=function(t){},r.onLoad=function(){this.initMusicEvent()},r.initMusicEvent=function(){var t=this;this.node.on("bgm",(function(){return t.soundControl.play()}),this),this.node.on("bgmStop",(function(){return t.soundControl.stop()}),this),this.node.on("gameover",(function(){return t.soundControl.playOneShot(t.effects[0],.7)}),this),this.node.on("cleanOneLine",(function(){return t.soundControl.playOneShot(t.effects[0],.6)}),this),this.node.on("rotate",(function(){return t.soundControl.playOneShot(t.effects[1],.6)}),this)},n}(a)).prototype,"soundControl",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=n(h.prototype,"effects",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),d=h))||d));r._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});